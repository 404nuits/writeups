Petit write-up pour le challenge Node Madness :

On commence en accédant au chall avec ce lien : http://nodemadness.ctf.midnightflag.fr/.

On arrive sur une page nous proposant un lien pour nous connecter. On choisit un username et un password au hasard (pas d'importance)

On arrive après s'être connecté sur une page nous montrant nos informations:

"Your current informations are : {"username":"admin","password":"admin","isAdmin":0}"

En ayant lu qu'il n'y avait pas de liens avec une base de données externe, on peut se demander si des cookies ne rentrent pas en jeu.

En regardant l'onglet Réseau de l'inspecteur d'élément, on peut voir dans le header de la requête profile (lors du chargement de la page profile) qu'il y a bel et bien un cookie.

Cookie: currentUser=eyJ1c2VybmFtZSI6ImFkbWluIiwicGFzc3dvcmQiOiJhZG1pbiIsImlzQWRtaW4iOjB9


En cherchant un peu, on trouve vite que le cookie est encodé en base64. On utilise un decoder en ligne (https://www.base64decode.org/   par exemple) et on obtient en clair :
{"username":"admin","password":"admin","isAdmin":0}


On a donc juste à modifier le cookie en passant la valeur de isAdmin à 1. On encode en base 64 ce qui nous donne : 
eyJ1c2VybmFtZSI6ImFkbWluIiwicGFzc3dvcmQiOiJhZG1pbiIsImlzQWRtaW4iOjF9

On va dans la console de l'inspecteur d'élément et on tape : document.cookie = "currentUser=eyJ1c2VybmFtZSI6ImFkbWluIiwicGFzc3dvcmQiOiJhZG1pbiIsImlzQWRtaW4iOjF9"

Si on refresh la page /profile, on voit bien que la valeur de isAdmin est à 1.

On a plus qu'a aller dans l'onglet /admin

Et on obtient : 

Welcome back admin !
Message of the day : MCTF{d0nt_st0r3_s3ns1t1v3_v4lu3s_1n_c00k13s}
